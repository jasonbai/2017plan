knitr::opts_chunk$set(echo = TRUE)
```{r}
library(readr)
df <- read_csv("~/Desktop/P4/wineQualityReds.csv")
View(df)
library("VIM")
library("VIM")
matrixplot(df)
df=na.omit(df)
library(ggplot2)
ggplot(df,aes(df$quality))+geom_histogram()
ggplot(df,aes(df$quality,df$alcohol))+geom_point()
require(corrplot)
#correlation analysis
cor1<-cor(df)
corrplot(cor1,tl.cex = 0.5)
lm1<-lm(df$quality~df$volatile.acidity+df$citric.acid+df$residual.sugar+df$chlorides+df$free.sulfur.dioxide+df$total.sulfur.dioxide+df$density+df$pH+df$sulphates+df$alcohol,data=df)
lm1
summary(lm1)
matrixplot(df)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
rm(list = ls())
library(readr)
library(ggplot2)
library(gridExtra)
library(GGally)
library(RColorBrewer)
library("VIM")
install.packages("VIM")
library("VIM")
# Load the Data
df <- read_csv("~/Desktop/P4/wineQualityReds.csv")
df <- read_csv("~/Desktop/P4/wineQualityReds.csv")
df <- read_csv("D:/GitHub/2017plan/Udacity/DAND/P4/wineQualityReds.csv")
summary(df)
dim(df)
ls(df)
matrixplot(df)
df=na.omit(df)
ggplot(df,aes(df$quality))+geom_histogram()
summary(df$quality)
ggplot(df,aes(df$quality))+geom_histogram()
summary(df$quality)
x <- subset(df, select = -c(quality))
aggregate(x,list(df$quality),median)
x <- subset(df, select = c(quality))
aggregate(x,list(df$quality),median)
x <- subset(df, select = -c(quality))
aggregate(x,list(df$quality),median)
subset(df, select = -c(quality))
subset(df, select = c(quality))
x <- subset(df, select = -c(quality))
aggregate(x,list(df$quality),median)
x <- subset(df, select = -c(quality))
aggregate(x,list(df$quality),median)
#create a new variable rating
df$rating<-ifelse(wwine$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
#create a new variable rating
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#describe the dataset using rating variable
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
#create a new variable rating
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#describe the dataset using rating variable
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
#构造等级变量
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
#构造等级变量
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good")))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#观察新变量
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
#构造等级变量
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#观察新变量
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
#构造等级变量
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#观察新变量
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
#构造等级变量
df$rating<-ifelse(df$quality<5,"bad",
ifelse(df$quality==5,"medium-low",
ifelse(df$quality==6,"medium",                                  ifelse(df$quality==7,"medium-high","good"))))
df$rating<-factor(df$rating,levels=c(
"bad","medium-low","medium","medium-high","good"
),ordered=T)
#观察新变量
table(df$rating)
qplot(data=df,x=rating)
x <- subset(df, select = -c(quality,rating))
aggregate(x,list(df$rating),median)
p1<-qplot(data=df,x=alcohol)
p2<-qplot(data=df,x=residual.sugar)
p3<-qplot(data=df,x=density)
grid.arrange(p1,p2,p3)
p1<-qplot(data=df,x=alcohol)
p2<-qplot(data=df,x=residual.sugar)
p3<-qplot(data=df,x=density)
grid.arrange(p1,p2,p3)
p1<-qplot(data=df,x=alcohol)
p2<-qplot(data=df,x=residual.sugar)
p3<-qplot(data=df,x=density)
grid.arrange(p1,p2,p3)
p1<-ggplot(aes(x=alcohol),data=df)+
geom_density()
#1og10 transform density and residual.sugar
p2<-ggplot(aes(x=log10(residual.sugar)),data=df)+
geom_density()
p3<-ggplot(aes(x=log10(density)),data=df)+
geom_density()
grid.arrange(p1,p2,p3)
p1<-qplot(data=df,x=log10(fixed.acidity))
p2<-qplot(data=df,x=log10(volatile.acidity))
p3<-qplot(data=df,x=log10(citric.acid))
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=log10(fixed.acidity))
p2<-qplot(data=df,x=log10(volatile.acidity))
p3<-qplot(data=df,x=log10(citric.acid))
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=log10(volatile.acidity))
p3<-qplot(data=df,x=log10(citric.acid))
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=log10(citric.acid))
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
grid.arrange(p1,p2,p3,p4,ncol=2)
p4<-qplot(data=df,x=pH)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
require(corrplot)
cor1<-cor(df)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
cor1<-cor(df)
View(df)
View(df)
p1<-qplot(data=df,x=fixed.acidity)
p2<-qplot(data=df,x=volatile.acidity)
p3<-qplot(data=df,x=citric.acid)
p4<-qplot(data=df,x=pH)
grid.arrange(p1,p2,p3,p4,ncol=2)
p1<-qplot(data=df,x=free.sulfur.dioxide,binwidth=4)
p2<-qplot(data=df,x=log10(free.sulfur.dioxide))
p3<-qplot(data=df,x=total.sulfur.dioxide,binwidth=5)
p4<-qplot(data=df,x=log10(total.sulfur.dioxide))
p5<-qplot(data=df,x=sulphates,binwidth=0.01)
p6<-qplot(data=df,x=log10(sulphates))
grid.arrange(p1,p2,p3,p4,p5,p6,ncol=2)
p1<-qplot(data=df,x=free.sulfur.dioxide,binwidth=4)
p2<-qplot(data=df,x=total.sulfur.dioxide,binwidth=5)
p3<-qplot(data=df,x=sulphates,binwidth=0.01)
grid.arrange(p1,p2,p3,p4,p5,p6,ncol=2)
p1<-qplot(data=df,x=free.sulfur.dioxide,binwidth=4)
p2<-qplot(data=df,x=total.sulfur.dioxide,binwidth=5)
p3<-qplot(data=df,x=sulphates,binwidth=0.01)
grid.arrange(p1,p2,p3)
p1<-qplot(data=df,x=chlorides,binwidth=0.001)
p2<-qplot(data=df,x=log10(chlorides),binwidth=0.01)
grid.arrange(p1,p2)
p1<-qplot(data=df,x=chlorides,binwidth=0.001)
p2<-qplot(data=df,x=log10(chlorides),binwidth=0.01)
grid.arrange(p1,p2)
p1<-qplot(data=df,x=chlorides,binwidth=0.001)
p2<-qplot(data=df,x=log10(chlorides),binwidth=0.01)
grid.arrange(p1,p2)
p1<-qplot(data=df,x=chlorides,binwidth=0.001)
p2<-qplot(data=df,x=log10(chlorides),binwidth=0.01)
grid.arrange(p1,p2)
View(df)
#compute the corelations between 12 variables
mat<-as.matrix(subset(df,select=c(1:12)))
cor_mat<-cor(mat)
cor_mat
#To look at it closely I display only correlation I am interested
#cor_mat<-ifelse((cor_mat<(-0.3) | cor_mat>0.3) & cor_mat!=1,cor_mat,NA)
#cor_mat
rm(mat,cor_mat)
require(corrplot)
#correlation analysis
mat<-as.matrix(subset(df,select=c(1:12)))
cor1<-cor(mat)
corrplot(cor1,tl.cex = 0.6)
corrplot(cor1,tl.cex = 0.6)
require(corrplot)
mat<-as.matrix(subset(df,select=c(1:12)))
cor1<-cor(mat)
corrplot(cor1,tl.cex = 0.6)
corrplot(cor1,tl.cex = 0.6, method = "number",cl.pos="n")
#compute the corelations between 12 variables
mat<-as.matrix(subset(df,select=c(1:12)))
cor_mat<-cor(mat)
cor_mat
#To look at it closely I display only correlation I am interested
#cor_mat<-ifelse((cor_mat<(-0.3) | cor_mat>0.3) & cor_mat!=1,cor_mat,NA)
#cor_mat
rm(mat,cor_mat)
corrplot(cor_mat,tl.cex = 0.6)
require(corrplot)
install.packages("corrplot")
require(corrplot)
mat<-as.matrix(subset(df,select=c(1:12)))
cor_mat<-cor(mat)
cor_mat
cor_mat
corrplot(cor_mat,tl.cex = 0.6)
